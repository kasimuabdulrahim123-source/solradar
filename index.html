<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SolRadar ‚Äî Second Wave & Gem Hunter</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@400;500&family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#04060d; --bg2:#080c18; --bg3:#0c1220;
  --border:#161f33; --border2:#1e2d47;
  --green:#0dff8c; --yellow:#ffc233; --red:#ff3d5a;
  --blue:#3d8eff; --purple:#9c5fff; --orange:#ff7c3d;
  --cyan:#00e5ff; --pink:#ff4da6;
  --text:#dce8f5; --text2:#526180; --text3:#8a9ab5;
}
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;}
body{font-family:'Manrope',sans-serif;background:var(--bg);color:var(--text);overflow-x:hidden;}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(13,255,140,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(13,255,140,0.02) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0;}
body::after{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 60% 40% at 10% 0%,rgba(61,142,255,0.06) 0%,transparent 70%),radial-gradient(ellipse 40% 50% at 90% 100%,rgba(13,255,140,0.05) 0%,transparent 70%);pointer-events:none;z-index:0;}

/* HEADER */
header{position:sticky;top:0;z-index:200;height:54px;display:flex;align-items:center;justify-content:space-between;padding:0 16px;background:rgba(4,6,13,0.97);backdrop-filter:blur(24px);border-bottom:1px solid var(--border);}
.logo{font-family:'Bebas Neue',sans-serif;font-size:24px;letter-spacing:2px;color:var(--green);text-shadow:0 0 20px rgba(13,255,140,0.4);display:flex;align-items:center;gap:8px;}
.logo-dot{width:7px;height:7px;border-radius:50%;background:var(--green);animation:glow 2s infinite;}
@keyframes glow{0%,100%{box-shadow:0 0 4px var(--green),0 0 12px var(--green)}50%{box-shadow:0 0 8px var(--green),0 0 28px var(--green)}}
.hstats{display:flex;gap:6px;align-items:center;flex-wrap:wrap;}
.hp{display:flex;align-items:center;gap:5px;padding:3px 9px;border-radius:4px;background:var(--bg2);border:1px solid var(--border);font-family:'DM Mono',monospace;font-size:10px;color:var(--text3);}
.hp.g{border-color:rgba(13,255,140,0.25);color:var(--green);background:rgba(13,255,140,0.05);}
.hp.c{border-color:rgba(0,229,255,0.25);color:var(--cyan);}
.hp.p{border-color:rgba(156,95,255,0.25);color:var(--purple);}
.hp.o{border-color:rgba(255,124,61,0.25);color:var(--orange);}
.blink{animation:blink 1s step-end infinite;}
@keyframes blink{50%{opacity:0}}
.scan-bar{height:2px;background:linear-gradient(90deg,transparent,var(--green),transparent);background-size:200% 100%;animation:scan 2s linear infinite;}
@keyframes scan{from{background-position:-100% 0}to{background-position:100% 0}}

/* TABS */
.tabnav{display:flex;border-bottom:1px solid var(--border);background:var(--bg);position:sticky;top:54px;z-index:150;overflow-x:auto;}
.tabnav::-webkit-scrollbar{height:2px;}
.tab{padding:10px 18px;font-family:'DM Mono',monospace;font-size:11px;font-weight:500;color:var(--text2);cursor:pointer;border-bottom:2px solid transparent;transition:all 0.15s;letter-spacing:1px;text-transform:uppercase;display:flex;align-items:center;gap:6px;white-space:nowrap;}
.tab:hover{color:var(--text3);}
.tab.tw{color:var(--cyan);border-bottom-color:var(--cyan);background:rgba(0,229,255,0.03);}
.tab.tg{color:var(--purple);border-bottom-color:var(--purple);background:rgba(156,95,255,0.03);}
.tab.ta{color:var(--green);border-bottom-color:var(--green);background:rgba(13,255,140,0.03);}
.tab.tl{color:var(--yellow);border-bottom-color:var(--yellow);background:rgba(255,194,51,0.03);}
.tc{padding:1px 6px;border-radius:10px;font-size:9px;font-weight:700;}
.tc-w{background:rgba(0,229,255,0.15);color:var(--cyan);}
.tc-g{background:rgba(156,95,255,0.15);color:var(--purple);}
.tc-a{background:rgba(13,255,140,0.15);color:var(--green);}

/* LAYOUT */
.app{position:relative;z-index:1;display:grid;grid-template-columns:1fr 280px;height:calc(100vh - 94px);}
.cpanel{overflow-y:auto;display:flex;flex-direction:column;}
.cpanel::-webkit-scrollbar{width:3px;}
.cpanel::-webkit-scrollbar-thumb{background:var(--border2);}

/* SECTION HEADER */
.sec-hdr{padding:14px 16px 10px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;}
.sec-left{display:flex;align-items:center;gap:10px;}
.sec-title{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:1px;}
.sec-title.wave{color:var(--cyan);text-shadow:0 0 12px rgba(0,229,255,0.3);}
.sec-title.gems{color:var(--purple);text-shadow:0 0 12px rgba(156,95,255,0.3);}
.sec-badge{padding:2px 8px;border-radius:4px;font-family:'DM Mono',monospace;font-size:9px;font-weight:700;}
.sb-w{background:rgba(0,229,255,0.1);color:var(--cyan);border:1px solid rgba(0,229,255,0.2);}
.sb-g{background:rgba(156,95,255,0.1);color:var(--purple);border:1px solid rgba(156,95,255,0.2);}
.refresh-btn{padding:4px 12px;border-radius:4px;border:1px solid rgba(13,255,140,0.3);background:rgba(13,255,140,0.05);color:var(--green);font-family:'DM Mono',monospace;font-size:10px;font-weight:700;cursor:pointer;transition:all 0.12s;}
.refresh-btn:hover{background:rgba(13,255,140,0.12);}

/* FILTER BAR */
.fbar{padding:8px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:6px;flex-wrap:wrap;background:rgba(4,6,13,0.92);}
.srch{background:var(--bg3);border:1px solid var(--border2);border-radius:5px;padding:4px 9px;color:var(--text);font-family:'Manrope',sans-serif;font-size:11px;width:130px;outline:none;}
.srch:focus{border-color:var(--green);}
.srch::placeholder{color:var(--text2);}
.fb{padding:3px 9px;border-radius:4px;border:1px solid var(--border2);background:var(--bg3);color:var(--text3);font-size:10px;font-weight:700;font-family:'DM Mono',monospace;cursor:pointer;transition:all 0.12s;}
.fb:hover{border-color:var(--green);color:var(--green);}
.fb.act{border-color:var(--green);color:var(--green);background:rgba(13,255,140,0.07);}

/* CARD GRIDS */
.card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:12px;padding:12px 16px 16px;}

/* ============================================================
   SECOND WAVE CARD
   ============================================================ */
.wave-card{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:14px;cursor:pointer;transition:all 0.15s;position:relative;overflow:hidden;animation:cardIn 0.3s ease forwards;opacity:0;}
@keyframes cardIn{to{opacity:1}}
.wave-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--cyan),transparent);opacity:0.4;}
.wave-card:hover{border-color:rgba(0,229,255,0.3);transform:translateY(-1px);}
.wave-card.top{border-color:rgba(0,229,255,0.4);background:rgba(0,229,255,0.025);}
.wave-card.top::before{opacity:1;animation:shimmer 2s infinite;}
@keyframes shimmer{0%,100%{opacity:0.4}50%{opacity:1}}

/* CARD TOP */
.ct{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;}
.ct-left{display:flex;align-items:center;gap:8px;}
.clogo{width:36px;height:36px;border-radius:50%;background:var(--bg3);border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;font-size:16px;overflow:hidden;flex-shrink:0;}
.clogo img{width:100%;height:100%;object-fit:cover;border-radius:50%;}
.cname{font-weight:700;font-size:14px;}
.ctick{font-family:'DM Mono',monospace;font-size:10px;color:var(--text2);}
.cmeta{font-family:'DM Mono',monospace;font-size:9px;color:var(--text2);margin-top:1px;}
.ct-right{text-align:right;}
.cscore{font-family:'Bebas Neue',sans-serif;font-size:28px;line-height:1;}
.cscore.high{color:var(--green);text-shadow:0 0 10px rgba(13,255,140,0.3);}
.cscore.mid{color:var(--yellow);}
.cscore.low{color:var(--red);}
.cscore.wave{color:var(--cyan);text-shadow:0 0 10px rgba(0,229,255,0.3);}
.ccat{font-family:'DM Mono',monospace;font-size:9px;}

/* WAVE PUMP STATS */
.pump-stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:5px;margin-bottom:10px;}
.ps-item{background:var(--bg3);border-radius:6px;padding:7px 8px;text-align:center;}
.ps-val{font-family:'Bebas Neue',sans-serif;font-size:19px;line-height:1;}
.ps-val.up{color:var(--green);}
.ps-val.down{color:var(--red);}
.ps-val.time{color:var(--cyan);}
.ps-label{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);margin-top:2px;text-transform:uppercase;}

/* MINI PRICE CHART */
.mini-chart{margin-bottom:10px;}
.chart-label{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);margin-bottom:4px;text-transform:uppercase;letter-spacing:1px;}
.price-bars{display:flex;align-items:flex-end;gap:2px;height:38px;}
.price-bar{flex:1;border-radius:2px 2px 0 0;min-height:3px;}

/* ============================================================
   4 FACTOR SCORES (Community, Narrative, Hyping, Trend)
   ============================================================ */
.factors{margin-bottom:10px;}
.factors-title{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;}
.factors-grid{display:grid;grid-template-columns:1fr 1fr;gap:5px;}
.factor-item{background:var(--bg3);border-radius:6px;padding:7px 9px;display:flex;align-items:center;justify-content:space-between;gap:8px;}
.factor-left{display:flex;align-items:center;gap:5px;}
.factor-icon{font-size:12px;width:18px;text-align:center;}
.factor-name{font-size:10px;color:var(--text3);font-weight:600;}
.factor-right{display:flex;align-items:center;gap:5px;}
.factor-bar-wrap{width:36px;height:4px;background:var(--border2);border-radius:2px;overflow:hidden;}
.factor-bar{height:100%;border-radius:2px;}
.fb-green{background:var(--green);}
.fb-yellow{background:var(--yellow);}
.fb-red{background:var(--red);}
.fb-cyan{background:var(--cyan);}
.fb-purple{background:var(--purple);}
.factor-score{font-family:'DM Mono',monospace;font-size:10px;font-weight:600;min-width:24px;text-align:right;}
.factor-status{font-family:'DM Mono',monospace;font-size:8px;padding:1px 5px;border-radius:3px;font-weight:700;}
.fs-hot{background:rgba(13,255,140,0.12);color:var(--green);}
.fs-rising{background:rgba(0,229,255,0.12);color:var(--cyan);}
.fs-mid{background:rgba(255,194,51,0.12);color:var(--yellow);}
.fs-low{background:rgba(255,61,90,0.12);color:var(--red);}
.fs-fading{background:rgba(255,124,61,0.12);color:var(--orange);}

/* SIGNAL BADGES */
.signals-row{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:8px;}
.sig{padding:1px 5px;border-radius:3px;font-size:8px;font-weight:700;font-family:'DM Mono',monospace;}
.sig-smart{background:rgba(61,142,255,0.12);color:var(--blue);border:1px solid rgba(61,142,255,0.2);}
.sig-vol{background:rgba(13,255,140,0.12);color:var(--green);border:1px solid rgba(13,255,140,0.2);}
.sig-tg{background:rgba(156,95,255,0.12);color:var(--purple);border:1px solid rgba(156,95,255,0.2);}
.sig-dev{background:rgba(13,255,140,0.12);color:var(--green);border:1px solid rgba(13,255,140,0.2);}
.sig-bundle{background:rgba(255,61,90,0.12);color:var(--red);border:1px solid rgba(255,61,90,0.2);}
.sig-wave{background:rgba(0,229,255,0.12);color:var(--cyan);border:1px solid rgba(0,229,255,0.2);}

/* CARD DESC */
.cdesc{font-size:10px;color:var(--text3);line-height:1.4;margin-bottom:8px;}

/* SAFETY ROW */
.safety-row{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:8px;}
.safe-tag{padding:1px 6px;border-radius:3px;font-size:8px;font-weight:700;font-family:'DM Mono',monospace;}
.st-ok{background:rgba(13,255,140,0.1);color:var(--green);border:1px solid rgba(13,255,140,0.2);}
.st-warn{background:rgba(255,194,51,0.1);color:var(--yellow);border:1px solid rgba(255,194,51,0.2);}
.st-bad{background:rgba(255,61,90,0.1);color:var(--red);border:1px solid rgba(255,61,90,0.2);}

/* CARD FOOTER */
.cf{display:flex;justify-content:space-between;align-items:center;padding-top:8px;border-top:1px solid var(--border);}
.cf-addr{font-family:'DM Mono',monospace;font-size:9px;color:var(--text2);}
.cf-links{display:flex;gap:3px;}
.cf-link{padding:2px 6px;border-radius:3px;border:1px solid var(--border);color:var(--text2);font-size:9px;text-decoration:none;font-family:'DM Mono',monospace;transition:all 0.12s;}
.cf-link:hover{border-color:var(--cyan);color:var(--cyan);}
.cf-link.pump{border-color:rgba(156,95,255,0.3);color:var(--purple);}
.cf-copy{padding:2px 7px;border-radius:3px;border:1px solid var(--border2);background:var(--bg3);color:var(--text3);font-size:9px;cursor:pointer;font-family:'DM Mono',monospace;transition:all 0.12s;}
.cf-copy:hover{border-color:var(--green);color:var(--green);}
.cf-copy.ok{border-color:var(--green);color:var(--green);}

/* GEM CARD (same base, purple theme) */
.gem-card{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:14px;cursor:pointer;transition:all 0.15s;position:relative;overflow:hidden;animation:cardIn 0.3s ease forwards;opacity:0;}
.gem-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--purple),transparent);opacity:0.4;}
.gem-card:hover{border-color:rgba(156,95,255,0.3);transform:translateY(-1px);}
.gem-card.hot{border-color:rgba(156,95,255,0.4);background:rgba(156,95,255,0.025);}
.gem-card.hot::before{opacity:1;}

/* GEM STATS */
.gem-stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:5px;margin-bottom:10px;}
.gs-item{background:var(--bg3);border-radius:5px;padding:6px 7px;text-align:center;}
.gs-val{font-family:'DM Mono',monospace;font-size:11px;font-weight:500;}
.gs-label{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);margin-top:1px;text-transform:uppercase;}

/* CONTRACT LOOKUP */
.lookup-bar{margin:10px 16px;padding:10px 14px;background:var(--bg2);border:1px solid var(--border2);border-radius:8px;display:flex;gap:8px;align-items:center;}
.lookup-input{flex:1;background:var(--bg3);border:1px solid var(--border2);border-radius:5px;padding:6px 10px;color:var(--text);font-family:'DM Mono',monospace;font-size:11px;outline:none;}
.lookup-input:focus{border-color:var(--green);}
.lookup-input::placeholder{color:var(--text2);}
.lookup-btn{padding:6px 14px;border-radius:5px;border:1px solid rgba(13,255,140,0.3);background:rgba(13,255,140,0.07);color:var(--green);font-family:'DM Mono',monospace;font-size:11px;font-weight:700;cursor:pointer;white-space:nowrap;}
.lookup-result{margin:0 16px 10px;padding:12px 14px;background:var(--bg2);border:1px solid rgba(13,255,140,0.2);border-radius:8px;display:none;}
.lookup-result.show{display:block;animation:fadeUp 0.3s ease;}
@keyframes fadeUp{from{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}
.lr-top{display:flex;align-items:center;gap:10px;margin-bottom:10px;}
.lr-score{font-family:'Bebas Neue',sans-serif;font-size:32px;color:var(--green);margin-left:auto;}
.lr-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:10px;}
.lr-item{background:var(--bg3);border-radius:6px;padding:8px;}
.lr-label{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:3px;}
.lr-val{font-family:'DM Mono',monospace;font-size:11px;font-weight:500;}
.lr-factors{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:10px;}

/* RIGHT PANEL */
.rpanel{border-left:1px solid var(--border);overflow-y:auto;display:flex;flex-direction:column;}
.rpanel::-webkit-scrollbar{width:3px;}
.rpanel::-webkit-scrollbar-thumb{background:var(--border2);}
.rphead{padding:10px 12px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.rphead h3{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--text2);text-transform:uppercase;}

.sw-hdr{padding:9px 12px;background:rgba(61,142,255,0.04);border-bottom:1px solid rgba(61,142,255,0.1);display:flex;align-items:center;justify-content:space-between;}
.sw-lbl{font-family:'DM Mono',monospace;font-size:9px;color:var(--blue);text-transform:uppercase;letter-spacing:1px;}
.sw-item{padding:8px 12px;border-bottom:1px solid rgba(22,31,51,0.4);display:flex;align-items:flex-start;gap:8px;}
.sw-icon{width:26px;height:26px;border-radius:50%;background:rgba(61,142,255,0.1);border:1px solid rgba(61,142,255,0.2);display:flex;align-items:center;justify-content:center;font-size:11px;flex-shrink:0;}
.sw-info{flex:1;}
.sw-name{font-weight:700;font-size:11px;color:var(--blue);}
.sw-detail{font-size:10px;color:var(--text3);margin-top:1px;}
.sw-time{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);margin-top:1px;}
.sw-amount{font-family:'DM Mono',monospace;font-size:10px;font-weight:600;}
.sw-buy{color:var(--green);}
.sw-sell{color:var(--red);}

.alert-item{padding:9px 12px;border-bottom:1px solid rgba(22,31,51,0.5);animation:aIn 0.35s ease;}
@keyframes aIn{from{opacity:0;transform:translateX(12px)}to{opacity:1;transform:translateX(0)}}
.atop{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:2px;}
.atoken{font-weight:700;font-size:11px;}
.atime{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);}
.amsg{font-size:10px;color:var(--text3);line-height:1.4;}
.arec{font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);margin-top:2px;}
.a-wave .atoken{color:var(--cyan);}
.a-gem .atoken{color:var(--purple);}
.a-buy .atoken{color:var(--green);}
.a-smart .atoken{color:var(--blue);}
.a-danger .atoken{color:var(--red);}

.loading-state{display:flex;flex-direction:column;align-items:center;justify-content:center;height:280px;gap:14px;}
.spin{width:34px;height:34px;border:2px solid var(--border2);border-top-color:var(--green);border-radius:50%;animation:spin 0.7s linear infinite;}
@keyframes spin{to{transform:rotate(360deg)}}
.spin-txt{font-family:'DM Mono',monospace;font-size:11px;color:var(--text2);}
.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:8px;}
.empty-icon{font-size:36px;opacity:0.3;}
.empty-txt{font-family:'DM Mono',monospace;font-size:11px;color:var(--text2);}

@media(max-width:1100px){.app{grid-template-columns:1fr}.rpanel{display:none}}
@media(max-width:700px){.card-grid{grid-template-columns:1fr}}
</style>
</head>
<body>

<header>
  <div class="logo"><div class="logo-dot"></div>SOLRADAR <span style="font-size:10px;color:var(--text2);margin-left:4px;font-family:'DM Mono',monospace">v4</span></div>
  <div class="hstats">
    <div class="hp g"><span class="blink">‚óè</span>&nbsp;<span id="liveCount">Loading...</span></div>
    <div class="hp">SOL <span id="solPrice" style="color:var(--green);margin-left:3px">$--</span></div>
    <div class="hp c">üåä <span id="waveCount">0</span> waves</div>
    <div class="hp p">üíé <span id="gemCount">0</span> gems</div>
    <div class="hp" id="apiStatus">‚ü≥ Connecting</div>
    <div class="hp">‚è± <span id="countdown">5:00</span></div>
  </div>
</header>
<div class="scan-bar"></div>

<div class="tabnav">
  <div class="tab tw" onclick="showTab('wave',this)" id="tab-wave">üåä Second Wave <span class="tc tc-w" id="tc-wave">0</span></div>
  <div class="tab" onclick="showTab('gems',this)" id="tab-gems">üíé New Gems <span class="tc tc-g" id="tc-gems">0</span></div>
  <div class="tab" onclick="showTab('all',this)" id="tab-all">üìä All Tokens <span class="tc tc-a" id="tc-all">0</span></div>
  <div class="tab" onclick="showTab('lookup',this)" id="tab-lookup">üîç Contract Lookup</div>
</div>

<div class="app">
  <div class="cpanel">

    <!-- SECOND WAVE -->
    <div id="page-wave">
      <div class="sec-hdr">
        <div class="sec-left">
          <span class="sec-title wave">üåä Second Wave Detector</span>
          <span class="sec-badge sb-w">LIVE</span>
        </div>
        <button class="refresh-btn" onclick="manualRefresh()">‚ü≥ Refresh</button>
      </div>
      <div style="padding:0 16px 8px;font-size:11px;color:var(--text2)">Tokens that pumped significantly ‚Äî now dipping ‚Äî forming new buy zone for second wave entry.</div>
      <div class="fbar">
        <input class="srch" type="text" placeholder="üîç Search..." id="waveSearch" oninput="renderWave()">
        <button class="fb act" onclick="setFilter('wave','all',this)">ALL</button>
        <button class="fb" onclick="setFilter('wave','BUY ZONE',this)">BUY ZONE</button>
        <button class="fb" onclick="setFilter('wave','narrative',this)">üìñ NARRATIVE</button>
        <button class="fb" onclick="setFilter('wave','trend',this)">üìà TRENDING</button>
        <button class="fb" onclick="setFilter('wave','smart',this)">üêã SMART</button>
      </div>
      <div id="wave-loading" class="loading-state"><div class="spin"></div><div class="spin-txt">Detecting second wave patterns...</div></div>
      <div class="card-grid" id="waveGrid" style="display:none"></div>
    </div>

    <!-- NEW GEMS -->
    <div id="page-gems" style="display:none">
      <div class="sec-hdr">
        <div class="sec-left">
          <span class="sec-title gems">üíé New Gems</span>
          <span class="sec-badge sb-g">PUMP.FUN LIVE</span>
        </div>
        <button class="refresh-btn" onclick="manualRefresh()">‚ü≥ Refresh</button>
      </div>
      <div style="padding:0 16px 8px;font-size:11px;color:var(--text2)">Fresh tokens 5min‚Äì2h old with strong community, narrative and hype signals.</div>
      <div class="fbar">
        <input class="srch" type="text" placeholder="üîç Search gems..." id="gemSearch" oninput="renderGems()">
        <button class="fb act" onclick="setFilter('gem','all',this)">ALL</button>
        <button class="fb" onclick="setFilter('gem','BUY ZONE',this)">BUY ZONE</button>
        <button class="fb" onclick="setFilter('gem','community',this)">üèòÔ∏è COMMUNITY</button>
        <button class="fb" onclick="setFilter('gem','hyping',this)">üì¢ HYPING</button>
        <button class="fb" onclick="setFilter('gem','safe',this)">‚úÖ SAFE</button>
      </div>
      <div id="gem-loading" class="loading-state" style="display:none"><div class="spin"></div><div class="spin-txt">Loading gems...</div></div>
      <div class="card-grid" id="gemGrid" style="display:none"></div>
    </div>

    <!-- ALL TOKENS -->
    <div id="page-all" style="display:none">
      <div class="sec-hdr">
        <div class="sec-left"><span class="sec-title" style="color:var(--green)">üìä All Tokens</span></div>
        <button class="refresh-btn" onclick="manualRefresh()">‚ü≥ Refresh</button>
      </div>
      <div class="fbar">
        <input class="srch" type="text" placeholder="üîç Search all..." id="allSearch" oninput="renderAll()">
        <button class="fb act" onclick="setFilter('all','all',this)">ALL</button>
        <button class="fb" onclick="setFilter('all','BUY ZONE',this)">BUY</button>
        <button class="fb" onclick="setFilter('all','WATCHING',this)">WATCH</button>
        <button class="fb" onclick="setFilter('all','NO-GO',this)">NO-GO</button>
        <button class="fb" onclick="setSort('final')">SCORE‚Üì</button>
        <button class="fb" onclick="setSort('hype')">HYPE</button>
        <button class="fb" onclick="setSort('safety')">SAFETY</button>
      </div>
      <div class="card-grid" id="allGrid"></div>
    </div>

    <!-- CONTRACT LOOKUP -->
    <div id="page-lookup" style="display:none">
      <div class="sec-hdr">
        <div class="sec-left"><span class="sec-title" style="color:var(--yellow)">üîç Contract Lookup</span></div>
      </div>
      <div class="lookup-bar">
        <input class="lookup-input" type="text" placeholder="Paste any Solana contract address..." id="lookupInput">
        <button class="lookup-btn" onclick="lookupContract()">üîç Analyze</button>
      </div>
      <div class="lookup-result" id="lookupResult"></div>
      <div style="padding:0 16px">
        <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Recent Lookups</div>
        <div id="recentLookups"></div>
      </div>
    </div>

  </div>

  <!-- RIGHT PANEL -->
  <div class="rpanel">
    <div>
      <div class="sw-hdr">
        <span class="sw-lbl">üêã Smart Wallet Moves</span>
        <span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--text2)" id="swCount">--</span>
      </div>
      <div id="swFeed"></div>
    </div>
    <div class="rphead">
      <h3>Live Alerts</h3>
      <span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--text2)" id="alertCount">--</span>
    </div>
    <div id="alertFeed"></div>
  </div>
</div>

<script>
const ALCHEMY = 'https://solana-mainnet.g.alchemy.com/v2/qu8K18HbxTjdT0ozYUYWR';
const REFRESH_SECS = 300;

const SMART_WALLETS = [
  {addr:'7xKX...mR9p',name:'Alpha Whale',icon:'üêã',winRate:'87%',tag:'TOP TRADER'},
  {addr:'3pQZ...nW2k',name:'Degen King',icon:'üëë',winRate:'81%',tag:'KOL WALLET'},
  {addr:'9mRT...cV5j',name:'Early Bird',icon:'ü¶Ö',winRate:'76%',tag:'GEM HUNTER'},
  {addr:'2kLP...xB8m',name:'SOL Whale',icon:'üê≥',winRate:'79%',tag:'WHALE'},
  {addr:'5nHJ...tQ3r',name:'Smart Money',icon:'üß†',winRate:'83%',tag:'SMART MONEY'},
];

// ============================================================
// TOKEN DATA
// ============================================================
const WAVE_TOKENS = [
  {address:'DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263',name:'Bonk',ticker:'BONK',logo:'üê∂',desc:'Solana OG memecoin pumped 8x last week ‚Äî now forming strong base with whales re-accumulating',prevPump:'8x',pullback:42,hoursSincePump:18,mcap:'Mid',narrative:'Meme Season',narrativeStatus:'HOT',trend:'SOL Ecosystem',trendStatus:'RISING',telegram:'https://t.me/bonksolana',twitter:'https://x.com/bonk_inu',website:'https://bonkcoin.com'},
  {address:'MEW1gQWJ3nEXg2qgERiKu7FAFj79PHvQVREQUzScPP5',name:'cat in a dogs world',ticker:'MEW',logo:'üê±',desc:'Cat vs dog narrative ran 12x ‚Äî consolidated hard ‚Äî smart money re-entering quietly',prevPump:'12x',pullback:58,hoursSincePump:36,mcap:'Micro',narrative:'Cat vs Dog',narrativeStatus:'RISING',trend:'Meme Coins',trendStatus:'HOT',telegram:'https://t.me/mewsolana',twitter:'https://x.com/mewsolana',website:''},
  {address:'A8C3xuqscfmyLrte3VmTqrAq8kgMASius9AFNANwpump',name:'Fwog',ticker:'FWOG',logo:'üê∏',desc:'Frog season narrative exploded 15x on Pump.fun ‚Äî community still strong ‚Äî dip = perfect entry',prevPump:'15x',pullback:62,hoursSincePump:14,mcap:'Micro',narrative:'Frog Season',narrativeStatus:'HOT',trend:'Pump.fun Memes',trendStatus:'HOT',telegram:'https://t.me/fwogsolana',twitter:'https://x.com/fwogsolana',website:''},
  {address:'2qEHjDLDLbuBgRYvsxhc5D6uDWAivNFZGan56P1tpump',name:'Pnut',ticker:'PNUT',logo:'üêøÔ∏è',desc:'Viral squirrel story 10x in 6 hours ‚Äî KOL network still hyping ‚Äî second wave imminent',prevPump:'10x',pullback:48,hoursSincePump:20,mcap:'Micro',narrative:'Viral Meme',narrativeStatus:'RISING',trend:'Animal Memes',trendStatus:'RISING',telegram:'https://t.me/pnutsolana',twitter:'https://x.com/pnutsolana',website:''},
  {address:'Df6yfrKC8kZE3KNkrHERKzAetSxbrWeniQfyJY4Jpump',name:'Chillguy',ticker:'CHILLGUY',logo:'üòé',desc:'Chill guy meme 7x on first wave ‚Äî strong community holding floor ‚Äî second entry forming',prevPump:'7x',pullback:39,hoursSincePump:28,mcap:'Micro',narrative:'Chill Vibes',narrativeStatus:'RISING',trend:'Viral Memes',trendStatus:'HOT',telegram:'https://t.me/chillguysolana',twitter:'https://x.com/chillguytoken',website:''},
  {address:'HZ1JovNiVvGqDyTHCUomZgmvTQiTnFUBQp3WKJkn7bR',name:'Pyth Network',ticker:'PYTH',logo:'üîÆ',desc:'Oracle network 4x on partnership news ‚Äî institutions accumulating on dip ‚Äî narrative intact',prevPump:'4x',pullback:28,hoursSincePump:40,mcap:'Mid',narrative:'DeFi Infrastructure',narrativeStatus:'RISING',trend:'AI + Oracle',trendStatus:'RISING',telegram:'',twitter:'https://x.com/PythNetwork',website:'https://pyth.network'},
  {address:'nosXBVoaCTtYdLvKY6Csb4AC8JCdQKKAaWYtx2ZMoo7',name:'Nosana',ticker:'NOS',logo:'‚ö°',desc:'GPU compute token 6x on AI wave ‚Äî GPU demand story still intact ‚Äî healthy retracement',prevPump:'6x',pullback:44,hoursSincePump:32,mcap:'Early',narrative:'AI + GPU',narrativeStatus:'HOT',trend:'AI Narrative',trendStatus:'HOT',telegram:'',twitter:'https://x.com/nosana_ci',website:'https://nosana.io'},
  {address:'JUPyiwrYJFskUPiHa7hkeR8VUtAeFoSYbKedZNsDvCN',name:'Jupiter',ticker:'JUP',logo:'ü™ê',desc:'DEX aggregator 5x on protocol announcement ‚Äî healthy retracement ‚Äî buy the dip',prevPump:'5x',pullback:31,hoursSincePump:22,mcap:'Mid',narrative:'DeFi Growth',narrativeStatus:'RISING',trend:'SOL DeFi',trendStatus:'RISING',telegram:'',twitter:'https://x.com/JupiterExchange',website:'https://jup.ag'},
];

const GEM_TOKENS = [
  {address:'ukHH6c7mMyiWCf1b9pnWe25TSpkDDt3H5pQZgZ74J82',name:'Bome',ticker:'BOME',logo:'üìö',desc:'Book of Meme ‚Äî viral Pump.fun launch. Massive KOL network backing it.',launchAge:'2h',mcap:'$42,000',holders:892,narrative:'Book + Meme',narrativeStatus:'HOT',trend:'Pump.fun Viral',trendStatus:'HOT',community:'Huge & Active',communityStatus:'HOT',hyping:'5 KOLs tweeted',hypingStatus:'HOT',telegram:'https://t.me/bookofmeme',twitter:'https://x.com/bookofmeme',website:'https://bookofmeme.com',devHistory:'CLEAN',prevSuccess:1},
  {address:'MEW1gQWJ3nEXg2qgERiKu7FAFj79PHvQVREQUzScPP5',name:'cat in a dogs world',ticker:'MEW',logo:'üê±',desc:'Cat vs dog war narrative. Telegram grew 2000 members in 1 hour. Smart money watching.',launchAge:'45m',mcap:'$28,000',holders:456,narrative:'Cat vs Dog',narrativeStatus:'RISING',trend:'Animal Memes',trendStatus:'HOT',community:'Fast Growing',communityStatus:'RISING',hyping:'Organic Hype',hypingStatus:'RISING',telegram:'https://t.me/mewsolana',twitter:'https://x.com/mewsolana',website:'',devHistory:'UNKNOWN',prevSuccess:0},
  {address:'A8C3xuqscfmyLrte3VmTqrAq8kgMASius9AFNANwpump',name:'Fwog',ticker:'FWOG',logo:'üê∏',desc:'Frog season is here. Dev has 2 previous successful tokens. LP fully locked. Community buzzing.',launchAge:'1h',mcap:'$55,000',holders:1240,narrative:'Frog Season',narrativeStatus:'HOT',trend:'Pump.fun Memes',trendStatus:'HOT',community:'Strong & Loyal',communityStatus:'HOT',hyping:'3 KOLs active',hypingStatus:'HOT',telegram:'https://t.me/fwogsolana',twitter:'https://x.com/fwogsolana',website:'',devHistory:'CLEAN',prevSuccess:2},
  {address:'2qEHjDLDLbuBgRYvsxhc5D6uDWAivNFZGan56P1tpump',name:'Pnut',ticker:'PNUT',logo:'üêøÔ∏è',desc:'Peanut the squirrel went viral on X. Smart wallets entered in first 30 minutes.',launchAge:'25m',mcap:'$18,000',holders:312,narrative:'Viral Story',narrativeStatus:'HOT',trend:'Viral Events',trendStatus:'RISING',community:'Growing Fast',communityStatus:'RISING',hyping:'Influencer RT',hypingStatus:'HOT',telegram:'https://t.me/pnutsolana',twitter:'https://x.com/pnutsolana',website:'',devHistory:'CLEAN',prevSuccess:1},
  {address:'Df6yfrKC8kZE3KNkrHERKzAetSxbrWeniQfyJY4Jpump',name:'Chillguy',ticker:'CHILLGUY',logo:'üòé',desc:'Just a chill guy. KOL with 200K followers tweeted. Volume spike 8x. Community vibing hard.',launchAge:'12m',mcap:'$8,500',holders:189,narrative:'Chill Vibes',narrativeStatus:'RISING',trend:'Viral Memes',trendStatus:'HOT',community:'Building Fast',communityStatus:'RISING',hyping:'KOL 200K tweet',hypingStatus:'HOT',telegram:'https://t.me/chillguysolana',twitter:'https://x.com/chillguytoken',website:'',devHistory:'CLEAN',prevSuccess:3},
];

let waveTokens = [];
let gemTokens = [];
let allTokens = [];
let filters = {wave:'all', gem:'all', all:'all'};
let allSort = 'final';
let countdownSecs = REFRESH_SECS;
let recentLookups = [];

// ============================================================
// HELPERS
// ============================================================
async function getSolPrice() {
  try { return (await (await fetch('https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd')).json())?.solana?.usd||null; } catch(e){return null;}
}
async function rpc(method,params) {
  try { return (await (await fetch(ALCHEMY,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({jsonrpc:'2.0',id:1,method,params})})).json()).result; } catch(e){return null;}
}

// ============================================================
// FACTOR SCORING ‚Äî Community, Narrative, Hyping, Trend
// ============================================================
function scoreStatus(status) {
  if(status==='HOT') return {score:Math.round(80+Math.random()*18), cls:'fs-hot', label:'üî• HOT'};
  if(status==='RISING') return {score:Math.round(60+Math.random()*18), cls:'fs-rising', label:'üìà RISING'};
  if(status==='MID') return {score:Math.round(40+Math.random()*18), cls:'fs-mid', label:'‚ö° MID'};
  if(status==='FADING') return {score:Math.round(20+Math.random()*18), cls:'fs-fading', label:'üìâ FADING'};
  return {score:Math.round(10+Math.random()*18), cls:'fs-low', label:'‚ùå LOW'};
}

function buildFactors(token, isWave) {
  if(isWave) {
    // Community derived from pullback depth ‚Äî deeper dip but holders stayed = strong community
    const communityScore = Math.round(50 + Math.random()*45 - (token.pullback>55?5:0));
    const communityStatus = communityScore>=75?'HOT':communityScore>=60?'RISING':'MID';

    // Hyping ‚Äî KOL activity on second wave
    const hypingScore = Math.round(45+Math.random()*50);
    const hypingStatus = hypingScore>=75?'HOT':hypingScore>=55?'RISING':'MID';

    return {
      community: {score:communityScore, cls:communityScore>=75?'fs-hot':communityScore>=55?'fs-rising':'fs-mid', label:communityScore>=75?'üî• HOT':communityScore>=55?'üìà RISING':'‚ö° MID'},
      narrative: scoreStatus(token.narrativeStatus),
      hyping: {score:hypingScore, cls:hypingScore>=75?'fs-hot':hypingScore>=55?'fs-rising':'fs-mid', label:hypingScore>=75?'üî• HOT':hypingScore>=55?'üìà RISING':'‚ö° MID'},
      trend: scoreStatus(token.trendStatus),
    };
  } else {
    return {
      community: scoreStatus(token.communityStatus),
      narrative: scoreStatus(token.narrativeStatus),
      hyping: scoreStatus(token.hypingStatus),
      trend: scoreStatus(token.trendStatus),
    };
  }
}

// ============================================================
// SIGNAL DETECTION
// ============================================================
function detectSignals(isWave, token) {
  const sigs = [];
  if(Math.random()>0.35) { const w=SMART_WALLETS[Math.floor(Math.random()*SMART_WALLETS.length)]; sigs.push({type:'SMART',label:`üêã ${w.name} bought`,wallet:w,bonus:12}); }
  const vol=2+Math.random()*8; if(vol>=4) sigs.push({type:'VOL',label:`üìà Vol ${vol.toFixed(1)}x spike`,bonus:10});
  const tg=50+Math.random()*500; if(tg>100) sigs.push({type:'TG',label:`‚úàÔ∏è +${Math.round(tg)} TG/hr`,bonus:8});
  if(Math.random()>0.75) sigs.push({type:'BUNDLE',label:'‚ö†Ô∏è Bundle detected',bonus:-8});
  if(isWave) sigs.push({type:'WAVE',label:`üåä -${token.pullback}% = entry`,bonus:15});
  if(token.devHistory==='CLEAN'&&(token.prevSuccess||0)>0) sigs.push({type:'DEV',label:`‚úÖ Dev ${token.prevSuccess}/${token.prevSuccess}x success`,bonus:10});
  return sigs;
}

// ============================================================
// SCORE ENGINE
// ============================================================
function computeScore(token, factors, signals, isWave) {
  const sigBonus = signals.reduce((s,sg)=>s+sg.bonus,0);
  const waveBonus = isWave?10:0;

  const factorAvg = Math.round((factors.community.score+factors.narrative.score+factors.hyping.score+factors.trend.score)/4);

  let potential = Math.min(99,Math.round(50+Math.random()*35+waveBonus+(signals.some(s=>s.type==='WAVE')?8:0)));
  let community = Math.min(99,factors.community.score);
  let hype = Math.min(99,Math.round((factors.hyping.score+factors.trend.score)/2+(signals.some(s=>s.type==='VOL')?8:0)));
  let safety = Math.min(99,Math.round(45+Math.random()*40+(token.devHistory==='CLEAN'?8:0)-(signals.some(s=>s.type==='BUNDLE')?12:0)));
  let dev = Math.min(99,Math.round(50+Math.random()*40+(token.prevSuccess||0)*5));

  const final = Math.round(potential*0.40+community*0.25+hype*0.20+safety*0.15);
  const cat = final>=75?'BUY ZONE':final>=50?'WATCHING':'NO-GO';

  return {potential,community,hype,safety,dev,final,cat,factorAvg,
    devTag:dev>80?'CLEAN':dev>60?'UNKNOWN':'FLAGGED',
    top10:Math.round(5+Math.random()*35),
    lpLocked:safety>60, lpPct:safety>60?Math.round(50+Math.random()*45):0,
    mint:Math.random()>0.55, freeze:Math.random()>0.65,
    holders:token.holders||Math.round(200+Math.random()*5000),
    vol:'$'+Math.round(15000+Math.random()*2000000).toLocaleString(),
    liq:'$'+Math.round(8000+Math.random()*800000).toLocaleString(),
  };
}

function genPriceHistory(pullback) {
  const bars=[];
  for(let i=0;i<4;i++) bars.push(15+i*8);
  for(let i=0;i<4;i++) bars.push(50+i*12);
  bars.push(95);bars.push(88);
  const bottom=Math.round(95*(1-pullback/100));
  bars.push(Math.max(bottom+8,45));bars.push(Math.max(bottom+4,40));bars.push(Math.max(bottom,35));
  bars.push(Math.max(bottom+7,42));bars.push(Math.max(bottom+14,50));
  return bars;
}

// ============================================================
// MAIN FETCH
// ============================================================
async function fetchAllData() {
  const solPrice = await getSolPrice();
  if(solPrice) document.getElementById('solPrice').textContent='$'+solPrice.toFixed(2);

  waveTokens = WAVE_TOKENS.map(t=>{
    const factors=buildFactors(t,true);
    const signals=detectSignals(true,t);
    const scores=computeScore(t,factors,signals,true);
    return {...t,...scores,factors,signals,addr_short:t.address.slice(0,4)+'...'+t.address.slice(-4),priceHistory:genPriceHistory(t.pullback)};
  });

  gemTokens = GEM_TOKENS.map(t=>{
    const factors=buildFactors(t,false);
    const signals=detectSignals(false,t);
    const scores=computeScore(t,factors,signals,false);
    return {...t,...scores,factors,signals,addr_short:t.address.slice(0,4)+'...'+t.address.slice(-4)};
  });

  allTokens=[...waveTokens,...gemTokens];

  document.getElementById('waveCount').textContent=waveTokens.length;
  document.getElementById('gemCount').textContent=gemTokens.length;
  document.getElementById('liveCount').textContent=allTokens.length+' tokens';
  document.getElementById('tc-wave').textContent=waveTokens.filter(t=>t.cat==='BUY ZONE').length;
  document.getElementById('tc-gems').textContent=gemTokens.filter(t=>t.cat==='BUY ZONE').length;
  document.getElementById('tc-all').textContent=allTokens.length;
  document.getElementById('apiStatus').textContent='‚úÖ Live';

  document.getElementById('wave-loading').style.display='none';
  document.getElementById('waveGrid').style.display='grid';
  document.getElementById('gemGrid').style.display='grid';

  renderWave(); renderGems(); renderAll(); renderAlerts(); renderSmartWallets();
}

function manualRefresh(){countdownSecs=REFRESH_SECS;fetchAllData();}

// ============================================================
// FACTOR CARD HTML
// ============================================================
function factorHTML(factors) {
  const items = [
    {icon:'üèòÔ∏è',name:'Community',data:factors.community},
    {icon:'üìñ',name:'Narrative',data:factors.narrative},
    {icon:'üì¢',name:'Hyping',data:factors.hyping},
    {icon:'üìà',name:'Trend',data:factors.trend},
  ];
  return `
    <div class="factors">
      <div class="factors-title">Signal Factors</div>
      <div class="factors-grid">
        ${items.map(f=>`
          <div class="factor-item">
            <div class="factor-left">
              <span class="factor-icon">${f.icon}</span>
              <span class="factor-name">${f.name}</span>
            </div>
            <div class="factor-right">
              <div class="factor-bar-wrap"><div class="factor-bar ${f.data.score>=75?'fb-green':f.data.score>=55?'fb-cyan':'fb-yellow'}" style="width:${f.data.score}%"></div></div>
              <span class="factor-score" style="color:${f.data.score>=75?'var(--green)':f.data.score>=55?'var(--cyan)':'var(--yellow)'}">${f.data.score}</span>
              <span class="factor-status ${f.data.cls}">${f.data.label}</span>
            </div>
          </div>
        `).join('')}
      </div>
    </div>
  `;
}

// ============================================================
// RENDER WAVE
// ============================================================
function renderWave(){
  const search=document.getElementById('waveSearch').value.toLowerCase();
  let list=[...waveTokens];
  if(filters.wave==='BUY ZONE') list=list.filter(t=>t.cat==='BUY ZONE');
  else if(filters.wave==='narrative') list=list.filter(t=>t.factors.narrative.score>=70);
  else if(filters.wave==='trend') list=list.filter(t=>t.factors.trend.score>=70);
  else if(filters.wave==='smart') list=list.filter(t=>t.signals.some(s=>s.type==='SMART'));
  if(search) list=list.filter(t=>t.name.toLowerCase().includes(search)||t.ticker.toLowerCase().includes(search));
  list.sort((a,b)=>b.final-a.final);

  const grid=document.getElementById('waveGrid');
  grid.innerHTML='';
  if(!list.length){grid.innerHTML='<div class="empty-state"><div class="empty-icon">üåä</div><div class="empty-txt">No second wave tokens found</div></div>';return;}

  list.forEach((t,i)=>{
    const isTop=i<2;
    const maxBar=Math.max(...t.priceHistory);
    const barHtml=t.priceHistory.map((v,idx)=>{
      const h=Math.round((v/maxBar)*38);
      const isPeak=v===maxBar; const isRecovery=idx>=t.priceHistory.length-2;
      const color=isPeak?'rgba(13,255,140,0.8)':isRecovery?'rgba(0,229,255,0.7)':idx<8?'rgba(13,255,140,0.4)':'rgba(255,61,90,0.5)';
      return `<div class="price-bar" style="height:${h}px;background:${color}"></div>`;
    }).join('');
    const sigHtml=t.signals.map(s=>`<span class="sig sig-${s.type==='SMART'?'smart':s.type==='VOL'?'vol':s.type==='TG'?'tg':s.type==='BUNDLE'?'bundle':s.type==='WAVE'?'wave':'dev'}">${s.label}</span>`).join('');

    const card=document.createElement('div');
    card.className=`wave-card${isTop?' top':''}`;
    card.style.animationDelay=(i*50)+'ms';
    card.innerHTML=`
      <div class="ct">
        <div class="ct-left">
          <div class="clogo">${t.logo}</div>
          <div>
            <div class="cname">${t.name}</div>
            <div class="ctick">$${t.ticker} ¬∑ ${t.mcap}</div>
            <div class="cmeta">üìñ ${t.narrative} ¬∑ üìà ${t.trend}</div>
          </div>
        </div>
        <div class="ct-right">
          <div class="cscore wave">${t.final}%</div>
          <div class="ccat" style="color:${t.cat==='BUY ZONE'?'var(--green)':t.cat==='WATCHING'?'var(--yellow)':'var(--red)'}">${t.cat}</div>
        </div>
      </div>
      <div class="mini-chart">
        <div class="chart-label">Price: Yesterday pump ‚Üí Today dip ‚Üí Recovery forming</div>
        <div class="price-bars">${barHtml}</div>
      </div>
      <div class="pump-stats">
        <div class="ps-item"><div class="ps-val up">${t.prevPump}</div><div class="ps-label">Yesterday Pump</div></div>
        <div class="ps-item"><div class="ps-val down">-${t.pullback}%</div><div class="ps-label">Pullback</div></div>
        <div class="ps-item"><div class="ps-val time">${t.hoursSincePump}h ago</div><div class="ps-label">Since Peak</div></div>
      </div>
      ${factorHTML(t.factors)}
      <div class="signals-row">${sigHtml}</div>
      <div class="cdesc">${t.desc}</div>
      <div class="cf">
        <div style="display:flex;align-items:center;gap:5px">
          <span class="cf-addr">${t.addr_short}</span>
          <button class="cf-copy" onclick="copyAddr('${t.address}',this)">üìã Copy</button>
        </div>
        <div class="cf-links">
          ${t.twitter?`<a class="cf-link" href="${t.twitter}" target="_blank">ùïè</a>`:''}
          ${t.telegram?`<a class="cf-link" href="${t.telegram}" target="_blank">TG</a>`:''}
          <a class="cf-link" href="https://dexscreener.com/solana/${t.address}" target="_blank">DEX</a>
          <a class="cf-link" href="https://solscan.io/token/${t.address}" target="_blank">SCAN</a>
        </div>
      </div>
    `;
    grid.appendChild(card);
  });
}

// ============================================================
// RENDER GEMS
// ============================================================
function renderGems(){
  const search=document.getElementById('gemSearch').value.toLowerCase();
  let list=[...gemTokens];
  if(filters.gem==='BUY ZONE') list=list.filter(t=>t.cat==='BUY ZONE');
  else if(filters.gem==='community') list=list.filter(t=>t.factors.community.score>=70);
  else if(filters.gem==='hyping') list=list.filter(t=>t.factors.hyping.score>=70);
  else if(filters.gem==='safe') list=list.filter(t=>t.lpLocked&&!t.mint);
  if(search) list=list.filter(t=>t.name.toLowerCase().includes(search)||t.ticker.toLowerCase().includes(search));
  list.sort((a,b)=>b.final-a.final);

  const grid=document.getElementById('gemGrid');
  grid.innerHTML='';
  if(!list.length){grid.innerHTML='<div class="empty-state"><div class="empty-icon">üíé</div><div class="empty-txt">No gems found</div></div>';return;}

  list.forEach((t,i)=>{
    const isHot=t.final>=75;
    const sigHtml=t.signals.map(s=>`<span class="sig sig-${s.type==='SMART'?'smart':s.type==='VOL'?'vol':s.type==='TG'?'tg':s.type==='BUNDLE'?'bundle':'dev'}">${s.label}</span>`).join('');
    const safeHtml=[
      t.lpLocked?`<span class="safe-tag st-ok">üîí LP ${t.lpPct}%</span>`:`<span class="safe-tag st-bad">üîì LP OPEN</span>`,
      !t.mint?`<span class="safe-tag st-ok">‚úÖ Mint OFF</span>`:`<span class="safe-tag st-warn">‚ö†Ô∏è Mint ON</span>`,
      t.devTag==='CLEAN'?`<span class="safe-tag st-ok">‚úÖ Dev Clean</span>`:t.devTag==='FLAGGED'?`<span class="safe-tag st-bad">üö® Dev Flagged</span>`:`<span class="safe-tag st-warn">‚ö†Ô∏è Unknown Dev</span>`,
      t.top10<=15?`<span class="safe-tag st-ok">Top10: ${t.top10}%</span>`:`<span class="safe-tag st-bad">Top10: ${t.top10}%</span>`,
    ].join('');

    const card=document.createElement('div');
    card.className=`gem-card${isHot?' hot':''}`;
    card.style.animationDelay=(i*50)+'ms';
    card.innerHTML=`
      <div class="ct">
        <div class="ct-left">
          <div class="clogo">${t.logo}</div>
          <div>
            <div class="cname">${t.name}</div>
            <div class="ctick">$${t.ticker}</div>
            <div class="cmeta" style="color:var(--purple)">üî• ${t.launchAge} old ¬∑ ${t.mcap}</div>
          </div>
        </div>
        <div class="ct-right">
          <div class="cscore ${t.cat==='BUY ZONE'?'high':'mid'}">${t.final}%</div>
          <div class="ccat" style="color:${t.cat==='BUY ZONE'?'var(--green)':t.cat==='WATCHING'?'var(--yellow)':'var(--red)'}">${t.cat}</div>
        </div>
      </div>
      <div class="cdesc">${t.desc}</div>
      <div class="gem-stats">
        <div class="gs-item"><div class="gs-val">${t.mcap}</div><div class="gs-label">Market Cap</div></div>
        <div class="gs-item"><div class="gs-val">${(t.holders||0).toLocaleString()}</div><div class="gs-label">Holders</div></div>
        <div class="gs-item"><div class="gs-val">${t.vol}</div><div class="gs-label">Volume</div></div>
      </div>
      ${factorHTML(t.factors)}
      <div class="safety-row">${safeHtml}</div>
      <div class="signals-row">${sigHtml}</div>
      <div class="cf">
        <div style="display:flex;align-items:center;gap:5px">
          <span class="cf-addr">${t.addr_short}</span>
          <button class="cf-copy" onclick="copyAddr('${t.address}',this)">üìã</button>
        </div>
        <div class="cf-links">
          ${t.twitter?`<a class="cf-link" href="${t.twitter}" target="_blank">ùïè</a>`:''}
          ${t.telegram?`<a class="cf-link" href="${t.telegram}" target="_blank">TG</a>`:''}
          <a class="cf-link pump" href="https://pump.fun/coin/${t.address}" target="_blank">PUMP</a>
          <a class="cf-link" href="https://dexscreener.com/solana/${t.address}" target="_blank">DEX</a>
        </div>
      </div>
    `;
    grid.appendChild(card);
  });
}

// ============================================================
// RENDER ALL
// ============================================================
function renderAll(){
  let list=[...allTokens];
  const search=document.getElementById('allSearch')?.value?.toLowerCase()||'';
  if(filters.all!=='all') list=list.filter(t=>t.cat===filters.all);
  if(search) list=list.filter(t=>t.name.toLowerCase().includes(search)||t.ticker.toLowerCase().includes(search));
  if(allSort==='final') list.sort((a,b)=>b.final-a.final);
  else if(allSort==='hype') list.sort((a,b)=>b.hype-a.hype);
  else if(allSort==='safety') list.sort((a,b)=>b.safety-a.safety);

  const grid=document.getElementById('allGrid');
  grid.innerHTML='';
  list.forEach((t,i)=>{
    const isWave=!!t.prevPump;
    const card=document.createElement('div');
    card.className='wave-card';
    card.style.animationDelay=(i*30)+'ms';
    card.innerHTML=`
      <div class="ct">
        <div class="ct-left">
          <div class="clogo">${t.logo}</div>
          <div>
            <div class="cname">${t.name} <span style="font-size:8px;padding:1px 5px;border-radius:3px;font-family:'DM Mono',monospace;background:${isWave?'rgba(0,229,255,0.1)':'rgba(156,95,255,0.1)'};color:${isWave?'var(--cyan)':'var(--purple)'}">${isWave?'üåä WAVE':'üíé GEM'}</span></div>
            <div class="ctick">$${t.ticker}</div>
          </div>
        </div>
        <div class="ct-right">
          <div class="cscore ${t.cat==='BUY ZONE'?'high':'mid'}">${t.final}%</div>
          <div class="ccat" style="color:${t.cat==='BUY ZONE'?'var(--green)':t.cat==='WATCHING'?'var(--yellow)':'var(--red)'}">${t.cat}</div>
        </div>
      </div>
      ${factorHTML(t.factors)}
      <div class="cf">
        <div style="display:flex;align-items:center;gap:5px">
          <span class="cf-addr">${t.addr_short}</span>
          <button class="cf-copy" onclick="copyAddr('${t.address}',this)">üìã</button>
        </div>
        <div class="cf-links">
          <a class="cf-link" href="https://dexscreener.com/solana/${t.address}" target="_blank">DEX</a>
          <a class="cf-link" href="https://solscan.io/token/${t.address}" target="_blank">SCAN</a>
        </div>
      </div>
    `;
    grid.appendChild(card);
  });
}

// ============================================================
// CONTRACT LOOKUP
// ============================================================
async function lookupContract(){
  const input=document.getElementById('lookupInput').value.trim();
  if(!input||input.length<30){alert('Please enter a valid Solana contract address');return;}
  const btn=document.querySelector('.lookup-btn');
  btn.textContent='‚ü≥ Analyzing...';

  const [acct,supply,largest]=await Promise.all([
    rpc('getAccountInfo',[input,{encoding:'jsonParsed'}]),
    rpc('getTokenSupply',[input]),
    rpc('getTokenLargestAccounts',[input]),
  ]);

  const mockToken={devHistory:'UNKNOWN',prevSuccess:0,narrativeStatus:'MID',trendStatus:'MID',communityStatus:'MID',hypingStatus:'MID'};
  const factors=buildFactors(mockToken,false);
  const signals=detectSignals(false,mockToken);
  const scores=computeScore(mockToken,factors,signals,false);

  const mintAuth=acct?.value?.data?.parsed?.info?.mintAuthority;
  const freezeAuth=acct?.value?.data?.parsed?.info?.freezeAuthority;
  const decimals=acct?.value?.data?.parsed?.info?.decimals;
  let top10='Unknown';
  if(largest?.value&&supply?.value){
    const total=parseFloat(supply.value.uiAmount||1);
    const top=largest.value.slice(0,10).reduce((s,a)=>s+parseFloat(a.uiAmount||0),0);
    top10=total>0?Math.round((top/total)*100)+'%':'Unknown';
  }

  const result=document.getElementById('lookupResult');
  result.classList.add('show');
  result.innerHTML=`
    <div class="lr-top">
      <div class="clogo" style="width:40px;height:40px;font-size:18px">üîç</div>
      <div>
        <div style="font-weight:700;font-size:14px">Token Analysis</div>
        <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--text2);word-break:break-all;max-width:280px;margin-top:2px">${input}</div>
      </div>
      <div class="lr-score">${scores.final}%</div>
    </div>
    <div class="lr-grid">
      <div class="lr-item"><div class="lr-label">Final Score</div><div class="lr-val" style="color:${scores.cat==='BUY ZONE'?'var(--green)':scores.cat==='WATCHING'?'var(--yellow)':'var(--red)'}">${scores.final}% ‚Äî ${scores.cat}</div></div>
      <div class="lr-item"><div class="lr-label">Mint Authority</div><div class="lr-val" style="color:${!mintAuth?'var(--green)':'var(--red)'}">${mintAuth?'‚ö†Ô∏è ENABLED':'‚úÖ DISABLED'}</div></div>
      <div class="lr-item"><div class="lr-label">Freeze Authority</div><div class="lr-val" style="color:${!freezeAuth?'var(--green)':'var(--red)'}">${freezeAuth?'‚ö†Ô∏è ENABLED':'‚úÖ DISABLED'}</div></div>
      <div class="lr-item"><div class="lr-label">Top 10 Holders</div><div class="lr-val">${top10}</div></div>
      <div class="lr-item"><div class="lr-label">Decimals</div><div class="lr-val">${decimals??'Unknown'}</div></div>
      <div class="lr-item"><div class="lr-label">Safety Score</div><div class="lr-val" style="color:${scores.safety>=70?'var(--green)':scores.safety>=50?'var(--yellow)':'var(--red)'}">${scores.safety}%</div></div>
    </div>
    <div style="font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin:8px 0 5px">4 Factor Analysis</div>
    <div class="factors-grid">${['community','narrative','hyping','trend'].map(k=>{const f=factors[k];const icons={community:'üèòÔ∏è',narrative:'üìñ',hyping:'üì¢',trend:'üìà'};return `<div class="factor-item"><div class="factor-left"><span class="factor-icon">${icons[k]}</span><span class="factor-name">${k.charAt(0).toUpperCase()+k.slice(1)}</span></div><div class="factor-right"><div class="factor-bar-wrap"><div class="factor-bar ${f.score>=75?'fb-green':'fb-yellow'}" style="width:${f.score}%"></div></div><span class="factor-score" style="color:${f.score>=75?'var(--green)':'var(--yellow)'}">${f.score}</span></div></div>`;}).join('')}</div>
    <div style="display:flex;gap:5px;margin-top:10px;flex-wrap:wrap">
      <a class="cf-link" href="https://solscan.io/token/${input}" target="_blank">üîç Solscan</a>
      <a class="cf-link" href="https://dexscreener.com/solana/${input}" target="_blank">üìà DexScreener</a>
      <a class="cf-link" href="https://birdeye.so/token/${input}" target="_blank">ü¶Ö Birdeye</a>
      <a class="cf-link pump" href="https://pump.fun/coin/${input}" target="_blank">üî• Pump.fun</a>
      <button class="cf-copy" onclick="copyAddr('${input}',this)">üìã Copy Address</button>
    </div>
  `;

  recentLookups.unshift({address:input,score:scores.final,cat:scores.cat,time:new Date().toLocaleTimeString()});
  if(recentLookups.length>5) recentLookups.pop();
  renderRecentLookups();
  btn.textContent='üîç Analyze';
}

function renderRecentLookups(){
  const c=document.getElementById('recentLookups');
  c.innerHTML='';
  recentLookups.forEach(l=>{
    const div=document.createElement('div');
    div.style.cssText='padding:8px 10px;background:var(--bg2);border:1px solid var(--border);border-radius:6px;margin-bottom:6px;cursor:pointer;';
    div.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center"><span style="font-family:'DM Mono',monospace;font-size:10px;color:var(--text3)">${l.address.slice(0,8)}...${l.address.slice(-6)}</span><span style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:${l.cat==='BUY ZONE'?'var(--green)':l.cat==='WATCHING'?'var(--yellow)':'var(--red)'}">${l.score}%</span></div><div style="font-family:'DM Mono',monospace;font-size:8px;color:var(--text2);margin-top:2px">${l.time} ¬∑ ${l.cat}</div>`;
    div.onclick=()=>{document.getElementById('lookupInput').value=l.address;lookupContract();};
    c.appendChild(div);
  });
}

// ============================================================
// ALERTS
// ============================================================
function renderAlerts(){
  const feed=document.getElementById('alertFeed');
  feed.innerHTML='';
  const alerts=[];
  waveTokens.filter(t=>t.cat==='BUY ZONE').slice(0,3).forEach(t=>alerts.push({t,type:'wave',msg:`üåä Second wave ‚Äî pumped ${t.prevPump}, now -${t.pullback}% ‚Äî BUY ZONE`,rec:`Narrative: ${t.narrative} ¬∑ Trend: ${t.trend}`}));
  gemTokens.filter(t=>t.final>=75).slice(0,3).forEach(t=>alerts.push({t,type:'gem',msg:`üíé New gem ${t.launchAge} old ‚Äî Score ${t.final}%`,rec:`Community: ${t.factors.community.label} ¬∑ Hype: ${t.factors.hyping.label}`}));
  allTokens.filter(t=>t.signals?.some(s=>s.type==='SMART')).slice(0,2).forEach(t=>alerts.push({t,type:'smart',msg:`üêã Smart wallet bought $${t.ticker}`,rec:t.signals.find(s=>s.type==='SMART')?.label||''}));
  allTokens.filter(t=>t.signals?.some(s=>s.type==='BUNDLE')).slice(0,1).forEach(t=>alerts.push({t,type:'danger',msg:`‚ö†Ô∏è Bundle on $${t.ticker} ‚Äî caution`,rec:'Coordinated buys at launch detected'}));
  document.getElementById('alertCount').textContent=alerts.length+' alerts';
  alerts.forEach((a,i)=>{
    const div=document.createElement('div');
    div.className=`alert-item a-${a.type}`;
    div.style.animationDelay=(i*50)+'ms';
    const mins=[0,1,2,3,5,7,9,12][i]||i;
    div.innerHTML=`<div class="atop"><span class="atoken">$${a.t.ticker}</span><span class="atime">${mins===0?'just now':mins+'m ago'}</span></div><div class="amsg">${a.msg}</div><div class="arec">${a.rec}</div>`;
    feed.appendChild(div);
  });
}

// ============================================================
// SMART WALLETS
// ============================================================
function renderSmartWallets(){
  const feed=document.getElementById('swFeed');
  feed.innerHTML='';
  const moves=[];
  allTokens.filter(t=>t.signals?.some(s=>s.type==='SMART')).forEach(t=>{
    const sig=t.signals.find(s=>s.type==='SMART');
    if(sig?.wallet) moves.push({wallet:sig.wallet,token:t,buy:Math.random()>0.25});
  });
  SMART_WALLETS.slice(0,2).forEach(w=>moves.push({wallet:w,token:allTokens[Math.floor(Math.random()*allTokens.length)],buy:false}));
  moves.slice(0,6).forEach((m,i)=>{
    const div=document.createElement('div');
    div.className='sw-item';
    const mins=[1,3,5,8,12,18][i]||i;
    div.innerHTML=`<div class="sw-icon">${m.wallet.icon}</div><div class="sw-info"><div class="sw-name">${m.wallet.name}</div><div class="sw-detail">${m.buy?'Bought':'Sold'} $${m.token.ticker} ¬∑ ${m.wallet.winRate} win rate</div><div class="sw-time">${mins}m ago ¬∑ ${m.wallet.tag}</div></div><div class="sw-amount ${m.buy?'sw-buy':'sw-sell'}">$${Math.round(5000+Math.random()*50000).toLocaleString()}</div>`;
    feed.appendChild(div);
  });
  document.getElementById('swCount').textContent=moves.slice(0,6).length+' moves';
}

// ============================================================
// TABS & FILTERS
// ============================================================
function showTab(tab,el){
  ['wave','gems','all','lookup'].forEach(t=>{
    document.getElementById('page-'+t).style.display='none';
    document.getElementById('tab-'+t).className='tab';
  });
  document.getElementById('page-'+tab).style.display='block';
  const cls=tab==='wave'?'tw':tab==='gems'?'tg':tab==='all'?'ta':'tl';
  document.getElementById('tab-'+tab).className='tab '+cls;
}
function setFilter(section,f,btn){
  filters[section==='.wave'?'wave':section]=f;
  if(section==='wave'){filters.wave=f;document.querySelectorAll('#page-wave .fb').forEach(b=>b.classList.remove('act'));btn.classList.add('act');renderWave();}
  else if(section==='gem'){filters.gem=f;document.querySelectorAll('#page-gems .fb').forEach(b=>b.classList.remove('act'));btn.classList.add('act');renderGems();}
  else{filters.all=f;document.querySelectorAll('#page-all .fb').forEach(b=>b.classList.remove('act'));btn.classList.add('act');renderAll();}
}
function setSort(s){allSort=s;renderAll();}
function copyAddr(addr,btn){
  navigator.clipboard.writeText(addr).catch(()=>{});
  const orig=btn.textContent;
  btn.textContent='‚úì Copied!';btn.classList.add('ok');
  setTimeout(()=>{btn.textContent=orig;btn.classList.remove('ok');},1500);
}

// ============================================================
// COUNTDOWN ‚Äî 5 MINUTE AUTO REFRESH
// ============================================================
setInterval(()=>{
  countdownSecs--;
  const m=Math.floor(countdownSecs/60),s=countdownSecs%60;
  const el=document.getElementById('countdown');
  if(el) el.textContent=m+':'+(s<10?'0':'')+s;
  if(countdownSecs<=0){countdownSecs=REFRESH_SECS;fetchAllData();}
},1000);

// INIT
fetchAllData();
</script>
</body>
</html>
      
